function get_text_nodes(){exclude="audio, applet, code, code *, .MathJax, .MathJax *, output, output *, pre, pre *, samp, samp *, script, style, textarea, var, var *";return retval=$("body").find("*").not(exclude).contents().filter(function(){return 3===this.nodeType&&$.trim(this.textContent)})}
function do_replace(a){a=a.replace(/(^|[-\u2014\s(\["])'/g,"$1\u2018");a=a.replace(/'/g,"\u2019");a=a.replace(/(^|[-\u2014/\[(\u2018\s])"/g,"$1\u201c");a=a.replace(/"/g,"\u201d");a=a.replace(/---/g,"\u2014");return a=a.replace(/--/g,"\u2013")}function smartify(){$text_nodes=get_text_nodes();$text_nodes.each(function(){this.textContent=do_replace(this.textContent)})};
